<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head><title>Reporte Ventas</title></head>
<body>
<div th:fragment="content" class="container mx-auto px-4 py-6">
    <h1 class="text-3xl font-bold mb-6"><i class="fas fa-chart-line mr-2"></i>Reporte de Ventas</h1>

    <!-- Filtros -->
    <div class="bg-white rounded-xl shadow p-6 mb-6">
        <form th:action="@{/reporte/ventas}" method="get" class="grid md:grid-cols-4 gap-4">
            <div>
                <label class="block text-sm font-semibold mb-2">Fecha Inicio</label>
                <input type="date" name="fechaInicio" th:value="${fechaInicio}" class="w-full px-3 py-2 border rounded-lg">
            </div>
            <div>
                <label class="block text-sm font-semibold mb-2">Fecha Fin</label>
                <input type="date" name="fechaFin" th:value="${fechaFin}" class="w-full px-3 py-2 border rounded-lg">
            </div>
            <div>
                <label class="block text-sm font-semibold mb-2">Método de Pago</label>
                <select name="metodoPago" class="w-full px-3 py-2 border rounded-lg">
                    <option value="">Todos</option>
                    <option value="Efectivo">Efectivo</option>
                    <option value="Tarjeta">Tarjeta</option>
                </select>
            </div>
            <div class="flex items-end">
                <button type="submit" class="w-full bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">
                    <i class="fas fa-search mr-2"></i>Filtrar
                </button>
            </div>
        </form>
    </div>

    <!-- Estadísticas -->
    <div class="grid md:grid-cols-3 gap-6 mb-6">
        <div class="bg-green-500 rounded-xl shadow-lg p-6 text-white">
            <p class="text-sm">Total Ventas</p>
            <p class="text-3xl font-bold" th:text="'$' + ${totalVentas}">$0</p>
        </div>
        <div class="bg-blue-500 rounded-xl shadow-lg p-6 text-white">
            <p class="text-sm">Cantidad</p>
            <p class="text-3xl font-bold" th:text="${cantidadVentas}">0</p>
        </div>
        <div class="bg-purple-500 rounded-xl shadow-lg p-6 text-white">
            <p class="text-sm">Promedio</p>
            <p class="text-3xl font-bold" th:text="'$' + ${promedioVenta}">$0</p>
        </div>
    </div>

    <!-- Exportar -->
    <div class="flex gap-4 mb-4">
        <a th:href="@{/reporte/ventas/excel(fechaInicio=${fechaInicio},fechaFin=${fechaFin},metodoPago=${metodoPago})}"
           class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
            <i class="fas fa-file-excel mr-2"></i>Excel
        </a>
        <a th:href="@{/reporte/ventas/pdf(fechaInicio=${fechaInicio},fechaFin=${fechaFin},metodoPago=${metodoPago})}"
           class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">
            <i class="fas fa-file-pdf mr-2"></i>PDF
        </a>
    </div>

    <!-- Tabla -->
    <div class="bg-white rounded-xl shadow overflow-hidden">
        <table class="min-w-full">
            <thead class="bg-gray-800 text-white">
            <tr>
                <th class="px-4 py-3 text-left">ID</th>
                <th class="px-4 py-3 text-left">Fecha</th>
                <th class="px-4 py-3 text-left">ID Cliente</th>
                <th class="px-4 py-3 text-left">Método Pago</th>
                <th class="px-4 py-3 text-right">Total</th>
                <th class="px-4 py-3 text-center">Estado</th>
            </tr>
            </thead>
            <tbody class="divide-y">
            <tr th:each="v : ${ventas}" class="hover:bg-gray-50">
                <td class="px-4 py-3" th:text="${v.idVenta}">1</td>
                <td class="px-4 py-3" th:text="${#temporals.format(v.fechaVenta, 'dd/MM/yyyy HH:mm')}">-</td>
                <td class="px-4 py-3" th:text="${v.idCliente != null ? v.idCliente : 'Genérica'}">-</td>
                <td class="px-4 py-3" th:text="${v.metodoPago}">-</td>
                <td class="px-4 py-3 text-right font-semibold" th:text="'$' + ${v.totalVenta}">$0</td>
                <td class="px-4 py-3 text-center">
                    <span class="px-2 py-1 rounded text-sm"
                          th:classappend="${v.estado.name() == 'COMPLETADA'} ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'"
                          th:text="${v.estado}">-</span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>
